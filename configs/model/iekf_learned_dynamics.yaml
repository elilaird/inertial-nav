# IEKF with learned bias correction + learned measurement covariance
# Replaces classical bias model with learned per-timestep accelerometer
# bias corrections from a causal 1D CNN, while keeping exact SE(3) kinematics.

name: "iekf_learned_dynamics"

# Inherit physics parameters from default
_target_: configs.model.iekf_learned_cov

# Override network configuration
networks:
  init_process_cov:
    enabled: true
    type: "InitProcessCovNet"
    architecture:
      output_dim: 6
      initial_beta: 3.0
      weight_scale: 10.0

  measurement_cov:
    enabled: true
    type: "MeasurementCovNet"
    architecture:
      input_channels: 6
      output_dim: 2
      cnn_channels: 32
      kernel_size: 5
      dilation: 3
      dropout: 0.5
      initial_beta: 3.0

  bias_correction:
    enabled: true
    type: "LearnedBiasCorrectionNet"
    architecture:
      input_channels: 6
      output_dim: 3
      max_correction: 0.5  # m/sÂ², physical bound
      cnn_channels: 32
      kernel_size: 5
      dilation: 3
      dropout: 0.5
      weight_scale: 0.01
      bias_scale: 0.01
